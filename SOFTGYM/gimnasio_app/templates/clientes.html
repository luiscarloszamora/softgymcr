{% extends "base.html" %}

{% block titulo %}Clientes - SOFTGYM{% endblock %}

{% block contenido %}
<div class="titulo mb-4 d-flex justify-content-between align-items-center border-bottom pb-2">
    <h2 class="text-danger fw-bold">💪 Clientes Registrados</h2>
    <a href="{{ url_for('cierre_contable') }}" class="btn btn-dark btn-custom">📊 Cierre Contable</a>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<table class="table table-bordered table-hover text-center align-middle">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Membresía</th>
            <th>Vencimiento</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for cliente in clientes %}
        <tr>
            <td><strong>{{ cliente.id }}</strong></td>
            <td>{{ cliente.nombre }}</td>
            <td>{{ cliente.membresia }}</td>
            <td>
                {{ cliente.vencimiento }}<br>
                {% if cliente.estado == 'ACTIVA' %}
                    <span class="badge bg-success">🟢 Activa</span>
                {% elif cliente.estado == 'VENCIDA' %}
                    <span class="badge bg-danger">🔴 Vencida</span>
                {% else %}
                    <span class="badge bg-secondary">❔ Desconocido</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('editar_cliente', id=cliente.id) }}" class="btn btn-warning btn-sm btn-custom">✏️ Editar</a>
                <a href="{{ url_for('registrar_pago', cliente_id=cliente.id) }}" class="btn btn-success btn-sm btn-custom">💳 Pago</a>
                <a href="{{ url_for('historial_pagos', cliente_id=cliente.id) }}" class="btn btn-info btn-sm btn-custom">📜 Historial</a>
                <a href="{{ url_for('eliminar_cliente', id=cliente.id) }}" class="btn btn-danger btn-sm btn-custom" onclick="return confirm('¿Eliminar cliente?')">🗑️ Eliminar</a>

            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

