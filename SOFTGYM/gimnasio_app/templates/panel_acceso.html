{% extends "base_panel.html" %}

{% block titulo %}Panel de Acceso - SOFTGYM{% endblock %}

{% block contenido %}
<div class="text-center mb-4">
    <h2 class="text-primary fw-bold">üõÇ Panel de acceso</h2>
    <p class="text-muted">Ingresa el ID del cliente para verificar acceso</p>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show text-center" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form method="POST" class="mx-auto text-center" style="max-width: 300px;" onsubmit="return validarID()">
    <input type="text" name="cliente_id" id="cliente_id" class="form-control form-control-lg text-center mb-3 fw-bold" placeholder="ID" readonly required>

    <div class="d-grid gap-2">
        {% for fila in [['1','2','3'], ['4','5','6'], ['7','8','9'], ['‚Üê','0','‚úîÔ∏è']] %}
            <div class="d-flex justify-content-between">
                {% for tecla in fila %}
                    <button type="button" class="btn btn-outline-primary btn-lg fw-bold flex-fill mx-1" onclick="presionar('{{ tecla }}')">{{ tecla }}</button>
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <button type="submit" id="submitBtn" class="d-none"></button>
</form>

<script>
    function presionar(tecla) {
        const input = document.getElementById("cliente_id");
        if (tecla === '‚Üê') {
            input.value = input.value.slice(0, -1);
        } else if (tecla === '‚úîÔ∏è') {
            if (validarID()) {
                document.getElementById("submitBtn").click();
            }
        } else {
            if (input.value.length < 6) {
                input.value += tecla;
            }
        }
    }

    function validarID() {
        const input = document.getElementById("cliente_id");
        const valor = input.value.trim();

        if (valor === "" || isNaN(valor) || parseInt(valor) <= 0 || valor.length > 6) {
            alert("‚ö†Ô∏è Ingresa un ID v√°lido");
            return false;
        }
        return true;
    }
</script>
{% endblock %}
